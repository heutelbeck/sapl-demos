/*
 * Comprehensive Demo Policy for SAPL Test Grammar Features
 *
 * This policy demonstrates various SAPL features that can be tested
 * with the new SAPLTest grammar.
 */
policy "comprehensiveDemo"
permit
    action == "access" & resource == "demo"
where
    // Subject validation
    subject.role == "admin" | subject.role == "user";

    // Function call
    time.dayOfWeek(<time.now>) =~ "MONDAY|TUESDAY|WEDNESDAY|THURSDAY|FRIDAY";

    // Attribute check
    var status = <system.status>;
    status == "online" | status == "maintenance";

    // Parameterized attribute
    var level = subject.<access.level("demo")>;
    level >= 1;
advice
    {
        "type": "log",
        "message": "Access granted to demo resource"
    }
obligation
    {
        "type": "audit",
        "action": "record_access",
        "timestamp": <time.now>
    }
transform
    resource |- {
        @.sensitiveData : filter.blacken
    }
